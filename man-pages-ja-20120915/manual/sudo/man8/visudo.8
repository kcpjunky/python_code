.\" Copyright (c) 1996,1998-2005, 2007-2012
.\" 	Todd C. Miller <Todd.Miller@courtesan.com>
.\" 
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\" 
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\" ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\" 
.\" Sponsored in part by the Defense Advanced Research Projects
.\" Agency (DARPA) and Air Force Research Laboratory, Air Force
.\" Materiel Command, USAF, under agreement number F39502-99-1-0512.
.\" 
.\" Japanese Version Copyright (c) 2000-2002 Yuichi SATO
.\"   and 2009 Yoichi Chonan
.\"         all rights reserved.
.\" Translated Sat Oct  7 14:39:18 JST 2000
.\"         by Yuichi SATO <ysato444@yahoo.co.jp>
.\" Updated & Modified Fri Dec  6 04:40:44 JST 2002 by Yuichi SATO
.\" New Translation (sudo-1.6.9p17) Fri Jan 23 10:31:17 JST 2009
.\"         by Yoichi Chonan <cyoichi@maple.ocn.ne.jp>
.\" Updated & Modified (sudo-1.7.2p1) Sat Nov 14 21:15:16 JST 2009
.\"         by Yoichi Chonan
.\" Updated & Modified (sudo-1.8.4p4) Wed May  9 12:26:33 JST 2012
.\"         by Yoichi Chonan
.\"
.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` 
.    ds C' 
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "VISUDO 8"
.TH VISUDO 8 "March 12, 2012" "1.8.4" "MAINTENANCE COMMANDS"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "名前"
\"O visudo \- edit the sudoers file
visudo \- sudoers ファイルを編集する
.SH "書式"
.IX Header "SYNOPSIS"
\&\fBvisudo\fR [\fB\-chqsV\fR] [\fB\-f\fR \fIsudoers\fR]
.SH "説明"
.IX Header "DESCRIPTION"
\&\fBvisudo\fR は \fIvipw\fR\|(8) によく似た安全なやり方で 
\&\fIsudoers\fR ファイルを編集する。 \fBvisudo\fR は \fIsudoers\fR 
ファイルをロックして、重複した編集が同時に行われないようにするとともに、
整合性をざっと調べ、文法エラーのチェックを行う。
\&\fIsudoers\fR ファイルが現在編集中だった場合は、
「try again later」というメッセージを端末に表示する。
.PP
\&\fBvisudo\fR が使用するエディタについては、コンパイル時に設定された
一つ以上のエディタからなるリストがプログラムに埋め込まれているが、
\&\fIsudoers\fR ファイルの \f(CW\*(C`Defaults\*(C'\fR 行で
\&\fIeditor\fR オプションを使えば、それを変更することができる。
このリストはデフォルトでは、\f(CW"/usr/bin/vi"\fR になっている。
通常 \fBvisudo\fR は、
環境変数 \f(CW\*(C`VISUAL\*(C'\fR や \f(CW\*(C`EDITOR\*(C'\fR
の値が上述のエディタ・リストに含まれるエディタでないかぎり、
そうした環境変数を使用しない。とは言え、
\&\fBvisudo\fR が
\&\fI\-\-with\-env\-editor\fR オプションを付けて configure されている場合や、
\&\fIsudoeres\fR ファイルの \f(CW\*(C`Defaults\*(C'\fR 行で
\&\fIenv_editor\fR オプションがセットされている場合は、\fBvisudo\fR は
\&\f(CW\*(C`VISUAL\*(C'\fR や \f(CW\*(C`EDITOR\*(C'\fR によって指定された
どんなエディタでも使用することになる。
これがセキュリティホールになりかねないことに注意してほしい。
単に \f(CW\*(C`VISUAL\*(C'\fR や \f(CW\*(C`EDITOR\*(C'\fR を設定するだけで、
ユーザが任意のプログラムを実行できるようになってしまうからだ。
.PP
\&\fBvisudo\fR は編集が終わると、\fIsudoers\fR ファイルの文法解析を行い、
文法エラーがあれば、変更を保存しない。\fBvisudo\fR はエラーを発見すると、
エラーが起きた行番号を知らせるメッセージを表示し、\*(L"What now?\*(R"
というプロンプトを出す。このとき、\*(L"e\*(R" を押せば、
\&\fIsudoers\fR ファイルを再編集できる。\*(L"x\*(R" を押せば、
変更を保存せず終了だし、\*(L"Q\*(R" を押せば、変更を保存して終了だ。
\&\*(L"Q\*(R" の選択は、くれぐれも慎重にやってほしい。なぜなら、
\&\fBvisudo\fR が文法エラーがあると考えるのなら、\fBsudo\fR
も同様に考えるはずであり、エラーが訂正されるまで、もう誰にも \fBsudo\fR
が使えなくなってしまうからだ。文法エラーが発見されたとき、\*(L"e\*(R"
を押して \fIsudoers\fR ファイルを編集しようとすると、
カーソルがファイルのエラーが起きた行に飛ぶ (エディタにその機能があればだが)。
.SH "オプション"
.IX Header "OPTIONS"
\&\fBvisudo\fR では以下のコマンドラインオプションが使用できる。
.IP "\-c" 12
.IX Item "-c"
\&\fBcheck-only\fR モードを有効にする。現在の \fIsudoers\fR ファイルの
文法エラー、所有者、アクセス権をチェックする
(訳注: 所有者とアクセス権のチェックをするのは sudo-1.8.4p3 以降である)。
\&\fB\-q\fR オプションが指定されていない場合は、メッセージを標準出力に表示して、
\&\fIsudoers\fR の状態を報告する。チェックが成功裡に終わった場合は、
\&\fBvisudo\fR は返り値 0 で終了する。
エラーに出会った場合の返り値は 1 である。
.IP "\-f \fIsudoers\fR" 12
.IX Item "-f sudoers"
\&\fIsudoers\fR ファイルの位置を指定・変更する。このオプションを付けると、
\&\fBvisudo\fR はデフォルトの \fI/etc/sudoers\fR ではなく、
ユーザが選んだ \fIsudoers\fR ファイルを編集 (あるいは、チェック)
することになる。ロックファイルとしては、指定された \fIsudoers\fR
ファイルの名前の末尾に \*(L".tmp\*(R" を付けたものが使われる。なお、
\&\fBcheck-only\fR モードの場合だけ、\fB\-f\fR の引数に \*(L"\-\*(R"
を指定することができる。
これは、標準入力から \fIsudoers\fR が読み込まれるということである。
.IP "\-h" 12
.IX Item "-h"
\&\fB\-h\fR (\fIhelp\fR) オプションを指定すると、
\&\fBvisudo\fR は標準出力に簡単なヘルプメッセージを表示して、終了する。
.IP "\-q" 12
.IX Item "-q"
\&\fBquiet\fR モードを有効にする。このモードでは、
文法エラーの詳細情報は表示されない。このオプションが役に立つのは、
\&\fB\-c\fR オプションと組み合わせたときだけである。
.IP "\-s" 12
.IX Item "-s"
\&\fIsudoers\fR ファイルの\fB厳密\fR (\fBstrict\fR) チェックを有効にする。
エイリアスを定義する前に使用すると、
\&\fBvisudo\fR がそれを文法エラーと見なすようになるわけだ。
ホスト名やユーザ名がアルファベットの大文字、数字、アンダースコア ('_')
だけから構成されている場合は、
そうしたものとエイリアスとの区別が付かないことに注意してほしい。
.IP "\-V" 12
.IX Item "-V"
\&\fB\-V\fR (version) オプションを指定すると、
\&\fBvisudo\fR はバージョン番号を表示して、終了する。
.SH "環境変数"
.IX Header "ENVIRONMENT"
以下の環境変数が参照されるかどうかは、\fIsudoers\fR の \fIeditor\fR や
\&\fIenv_editor\fR オプションの値次第である。
.ie n .IP "\*(C`VISUAL\*(C'" 16
.el .IP "\f(CW\*(C`VISUAL\*(C'\fR" 16
.IX Item "VISUAL"
visudo が起動するエディタ
.ie n .IP "\*(C`EDITOR\*(C'" 16
.el .IP "\f(CW\*(C`EDITOR\*(C'\fR" 16
.IX Item "EDITOR"
\&\s-1VISUAL\s0 が設定されていないとき visudo が使用するエディタ
.SH "ファイル"
.IX Header "FILES"
.ie n .IP "\fI/etc/sudoers\fR" 24
.el .IP "\fI/etc/sudoers\fR" 24
.IX Item "/etc/sudoers"
誰が何を実行できるかのリスト
.ie n .IP "\fI/etc/sudoers.tmp\fR" 24
.el .IP "\fI/etc/sudoers.tmp\fR" 24
.IX Item "/etc/sudoers.tmp"
visudo が使うロックファイル
.SH "メッセージによる診断"
.IX Header "DIAGNOSTICS"
.IP "sudoers file busy, try again later." 4
.IX Item "sudoers file busy, try again later."
現在、ほかの誰かが \fIsudoers\fR ファイルを編集中である。
.ie n .IP "/etc/sudoers.tmp: Permission denied" 4
.el .IP "\f(CW@sysconfdir\fR@/sudoers.tmp: Permission denied" 4
\&\fBvisudo\fR を root として実行しなかった。
.IP "Can't find you in the passwd database" 4
.IX Item "Can't find you in the passwd database"
あなたのユーザ ID はシステムの passwd ファイルに載っていない。
.IP "Warning: {User,Runas,Host,Cmnd}_Alias referenced but not defined" 4
.IX Item "Warning: {User,Runas,Host,Cmnd}_Alias referenced but not defined"
User_Alias (あるいは、Runas_Alias, Host_Alias, Cmnd_Alias)
を、定義しないまま使用しようとしている。
あるいは、記載したユーザ名かホスト名の中に、アルファベットの大文字、
数字、アンダースコア ('_') のみからなるものがある。後者の場合は、
この warning を無視して構わない (\fBsudo\fR は警告を出さないないだろう)。
\&\fB\-s\fR (strict) モードでは、warning ではなく、error になる。
.IP "Warning: unused {User,Runas,Host,Cmnd}_Alias" 4
.IX Item "Warning: unused {User,Runas,Host,Cmnd}_Alias"
指摘された User_Alias (あるいは、Runas_Alias, Host_Alias, Cmnd_Alias) は、
定義されているが、一度も使用されていない。そうした使用しないエイリアスは、
コメントアウトするなり、消去するなりしてもよい。
\&\fB\-s\fR (strict) モードでは、warning ではなく、error になる。
.IP "Warning: cycle in {User,Runas,Host,Cmnd}_Alias" 4
.IX Item "Warning: cycle in {User,Runas,Host,Cmnd}_Alias"
指摘された User_Alias (あるいは、Runas_Alias, Host_Alias, Cmnd_Alias) は、
直接自分自身を参照しているか、
構成要素のエイリアスを通して自分自身を参照している。
\&\fBsudo\fR は \fIsudoers\fR を解析するとき、
循環を無視するので、これはデフォルトでは、単なる警告になっている。
.SH "関連項目"
.IX Header "SEE ALSO"
\&\fIvi\fR\|(1), \fIsudoers\fR\|(5), \fIsudo\fR\|(8), \fIvipw\fR\|(8)
.SH "作者"
.IX Header "AUTHOR"
多数の人々が長年に渡って \fBsudo\fR の開発に取り組んできた。
\&\fBvisudo\fR の当バージョンを書いたのは、
.PP
.Vb 1
\& Todd Miller
.Ve
.PP
である。\fBsudo\fR の開発に貢献してくださった方々のリストについては、
\&\fBsudo\fR の配布に含まれる \s-1CONTRIBUTORS\s0 ファイルをご覧いただきたい
(http://www.sudo.ws/sudo/contributors.html)。 
.SH "警告"
.IX Header "CAVEATS"
\&\fBvisudo\fR が使用するエディタでシェル・エスケープが可能なかぎり、
ユーザがルート・シェルを獲得するのを防止する簡単な方法はない。
.SH "バグ"
.IX Header "BUGS"
\&\fBvisudo\fR にバクを発見したと思ったら、下記のページにアクセスして、
バグレポートを提出していただきたい。
.br
http://www.sudo.ws/sudo/bugs/
.SH "サポート"
.IX Header "SUPPORT"
ある程度の無料サポートが sudo-users メーリングリストを通して利用できる。
購読やアーカイブの検索には下記 URL を御覧になること。
.br
http://www.sudo.ws/mailman/listinfo/sudo\-users
.SH "免責"
.IX Header "DISCLAIMER"
\&\fBvisudo\fR は「現状のまま」提供される。
明示的な、あるいは黙示的ないかなる保証も、
商品性や特定目的への適合性についての黙示的な保証を含め、
またそれのみに止まらず、これを否認する。詳細な全文については、
\&\fBsudo\fR と一緒に配布されている \s-1LICENSE\s0 ファイルや、
下記 Web ページを御覧いただきたい。
.br
http://www.sudo.ws/sudo/license.html
